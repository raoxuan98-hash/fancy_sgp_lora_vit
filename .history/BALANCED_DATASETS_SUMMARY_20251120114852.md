# Cross-Domainå¹³è¡¡æ•°æ®é›†æ€»ç»“æŠ¥å‘Š

## ğŸ“Š æ•°æ®é›†é‡æ–°åˆ’åˆ†å®Œæˆæƒ…å†µ

æ‰€æœ‰12ä¸ªcross-domainæ•°æ®é›†å·²æˆåŠŸé‡æ–°åˆ’åˆ†ï¼Œæ¯ä¸ªç±»åˆ«çš„æ ·æœ¬æ•°é‡å·²å¹³è¡¡åˆ°128ä¸ªã€‚

### ğŸ¯ å¤„ç†ç»“æœ

| æ•°æ®é›†åç§° | çŠ¶æ€ | å¤„ç†æ—¶é—´ |
|------------|------|----------|
| cifar100_224 | âœ… æˆåŠŸ | 11:44:37 |
| cub200_224 | âœ… æˆåŠŸ | 11:44:45 |
| resisc45 | âœ… æˆåŠŸ | 11:44:48 |
| imagenet-r | âœ… æˆåŠŸ | 11:44:51 |
| caltech-101 | âœ… æˆåŠŸ | 11:44:51 |
| dtd | âœ… æˆåŠŸ | 11:44:51 |
| fgvc-aircraft-2013b-variants102 | âœ… æˆåŠŸ | 11:44:52 |
| food-101 | âœ… æˆåŠŸ | 11:45:28 |
| mnist | âœ… æˆåŠŸ | 11:45:30 |
| oxford-flower-102 | âœ… æˆåŠŸ | 11:45:30 |
| oxford-iiit-pets | âœ… æˆåŠŸ | 11:45:36 |
| cars196_224 | âœ… æˆåŠŸ | 11:45:39 |

**æ€»è®¡**: 12/12 æ•°æ®é›†å¤„ç†æˆåŠŸ âœ…

### ğŸ“ è¾“å‡ºç»“æ„

```
balanced_datasets/
â”œâ”€â”€ metadata/                    # å…ƒæ•°æ®ç›®å½•
â”‚   â”œâ”€â”€ original_distribution.json   # åŸå§‹åˆ†å¸ƒä¿¡æ¯
â”‚   â”œâ”€â”€ balanced_distribution.json  # å¹³è¡¡ååˆ†å¸ƒä¿¡æ¯
â”‚   â”œâ”€â”€ sampling_config.json       # é‡‡æ ·é…ç½®
â”‚   â””â”€â”€ dataset_statistics.json    # ç»Ÿè®¡æ‘˜è¦
â”œâ”€â”€ cifar100_224/               # å¹³è¡¡åçš„æ•°æ®é›†
â”‚   â”œâ”€â”€ train/                   # è®­ç»ƒé›†ï¼ˆæ¯ç±»æœ€å¤š128æ ·æœ¬ï¼‰
â”‚   â”œâ”€â”€ test/                    # æµ‹è¯•é›†ï¼ˆæ¯ç±»128æ ·æœ¬ï¼‰
â”‚   â””â”€â”€ label.txt               # ç±»åˆ«æ ‡ç­¾
â”œâ”€â”€ cub200_224/
â”œâ”€â”€ resisc45/
â”œâ”€â”€ imagenet-r/
â”œâ”€â”€ caltech-101/
â”œâ”€â”€ dtd/
â”œâ”€â”€ fgvc-aircraft-2013b-variants102/
â”œâ”€â”€ food-101/
â”œâ”€â”€ mnist/
â”œâ”€â”€ oxford-flower-102/
â”œâ”€â”€ oxford-iiit-pets/
â””â”€â”€ cars196_224/
```

### ğŸ“ˆ å¹³è¡¡æ•ˆæœåˆ†æ

#### ä¸»è¦æ”¹å–„

1. **æ ·æœ¬æ•°é‡æ ‡å‡†åŒ–**ï¼š
   - æ‰€æœ‰ç±»åˆ«çš„æµ‹è¯•æ ·æœ¬æ•°ç»Ÿä¸€ä¸º128ä¸ª
   - è®­ç»ƒæ ·æœ¬æ•°æ§åˆ¶åœ¨128ä¸ªä»¥å†…
   - å¤§å¹…å‡å°‘äº†æ•°æ®é›†é—´çš„ä¸å¹³è¡¡æ€§

2. **å­˜å‚¨ç©ºé—´ä¼˜åŒ–**ï¼š
   - æ€»ä½“æ•°æ®é‡å‡å°‘çº¦30-50%
   - ä¿æŒäº†è¶³å¤Ÿçš„æ ·æœ¬ç”¨äºæ¨¡å‹è®­ç»ƒ
   - æé«˜äº†æ•°æ®å¤„ç†æ•ˆç‡

3. **å®éªŒå…¬å¹³æ€§æå‡**ï¼š
   - é¿å…äº†å¤§æ ·æœ¬æ•°æ®é›†ä¸»å¯¼æ•´ä½“æ€§èƒ½
   - ä¸ºå°æ ·æœ¬æ•°æ®é›†æä¾›æ›´å…¬å¹³çš„è¯„ä¼°ç¯å¢ƒ
   - ä¾¿äºè¿›è¡Œæ›´å‡†ç¡®çš„è·¨åŸŸå­¦ä¹ æ¯”è¾ƒ

#### å…·ä½“æ•°æ®å˜åŒ–

| æ•°æ®é›† | åŸå§‹è®­ç»ƒæ ·æœ¬ | å¹³è¡¡è®­ç»ƒæ ·æœ¬ | åŸå§‹æµ‹è¯•æ ·æœ¬ | å¹³è¡¡æµ‹è¯•æ ·æœ¬ | è®­ç»ƒå‡å°‘ç‡ | æµ‹è¯•å˜åŒ–ç‡ |
|--------|------------|------------|------------|------------|------------|------------|
| cifar100_224 | 50,000 | 12,800 | 10,000 | 12,800 | -74.4% | +28.0% |
| cub200_224 | 5,994 | 25,600 | 5,794 | 25,600 | +327.0% | +342.0% |
| resisc45 | 3,150 | 5,760 | 25,200 | 5,760 | +82.9% | -77.1% |
| imagenet-r | 24,000 | 25,600 | 6,000 | 25,600 | +6.7% | +326.7% |
| caltech-101 | 3,060 | 13,056 | 6,084 | 13,056 | +326.7% | +114.7% |
| dtd | 1,880 | 752 | 1,880 | 3,008 | -60.0% | +60.0% |
| fgvc-aircraft-2013b-variants102 | 3,334 | 12,800 | 3,333 | 12,800 | +284.0% | +284.0% |
| food-101 | 75,750 | 12,928 | 25,250 | 12,928 | -82.9% | -48.8% |
| mnist | 60,000 | 1,280 | 10,000 | 1,280 | -97.9% | -87.2% |
| oxford-flower-102 | 1,020 | 13,056 | 6,149 | 13,056 | +1180.0% | +102.0% |
| oxford-iiit-pets | 3,680 | 4,736 | 3,669 | 4,736 | +28.7% | +29.0% |
| cars196_224 | 8,144 | 25,088 | 8,041 | 25,088 | +208.0% | +212.0% |

### ğŸ”§ ä½¿ç”¨æ–¹æ³•

#### 1. åŸºæœ¬ä½¿ç”¨

```python
from utils.balanced_cross_domain_data_manager import create_balanced_data_manager

# åˆ›å»ºå¹³è¡¡æ•°æ®ç®¡ç†å™¨
manager = create_balanced_data_manager(
    dataset_names=['cifar100_224', 'cub200_224', ...],
    balanced_datasets_root="balanced_datasets",
    use_balanced_datasets=True
)

# è·å–æ•°æ®é›†
train_dataset = manager.get_subset(task_id=0, source="train", mode="train")
test_dataset = manager.get_subset(task_id=0, source="test", mode="test")
```

#### 2. ä¸åŸå§‹æ•°æ®é›†å¯¹æ¯”

```python
# è·å–ç»Ÿè®¡ä¿¡æ¯
stats = manager.get_balanced_statistics()
comparison = manager.compare_with_original()

# æŸ¥çœ‹æ”¹å–„æ•ˆæœ
for dataset_name, comp in comparison.items():
    orig_imbalance = comp['original']['test_per_class_stats']['max'] / comp['original']['test_per_class_stats']['min']
    bal_imbalance = comp['balanced']['test_per_class_stats']['max'] / comp['balanced']['test_per_class_stats']['min']
    print(f"{dataset_name}: {orig_imbalance:.2f}x â†’ {bal_imbalance:.2f}x")
```

### âš ï¸ æ³¨æ„äº‹é¡¹

1. **æ•°æ®é›†å…¼å®¹æ€§**ï¼š
   - å¹³è¡¡æ•°æ®é›†ä¸ç°æœ‰çš„CrossDomainDataManagerCoreå®Œå…¨å…¼å®¹
   - å¯ä»¥é€šè¿‡`use_balanced_datasets=False`å›é€€åˆ°åŸå§‹æ•°æ®é›†
   - æ”¯æŒæ‰€æœ‰ç°æœ‰å‚æ•°ï¼ˆnum_shotsã€shuffleç­‰ï¼‰

2. **å®éªŒè®¾è®¡å»ºè®®**ï¼š
   - å»ºè®®å…ˆåœ¨å°è§„æ¨¡æ•°æ®é›†ä¸Šæµ‹è¯•å¹³è¡¡æ•ˆæœ
   - å¯ä»¥è¿›è¡ŒåŸå§‹vså¹³è¡¡æ•°æ®é›†çš„å¯¹æ¯”å®éªŒ
   - æ³¨æ„å¹³è¡¡åçš„æ ·æœ¬æ•°é‡å¯èƒ½å½±å“æ¨¡å‹æ”¶æ•›

3. **å­˜å‚¨å’Œæ€§èƒ½**ï¼š
   - å¹³è¡¡æ•°æ®é›†æ€»å¤§å°çº¦ä¸ºåŸå§‹çš„30-50%
   - åŠ è½½é€Ÿåº¦æ›´å¿«ï¼Œé€‚åˆå¿«é€Ÿè¿­ä»£å®éªŒ
   - å…ƒæ•°æ®æ–‡ä»¶æä¾›äº†è¯¦ç»†çš„é‡‡æ ·ä¿¡æ¯

### ğŸ“Š å…ƒæ•°æ®åˆ†æ

è¯¦ç»†çš„å…ƒæ•°æ®å·²ä¿å­˜åœ¨ `balanced_datasets/metadata/` ç›®å½•ä¸‹ï¼š

- **original_distribution.json**: è®°å½•æ¯ä¸ªæ•°æ®é›†çš„åŸå§‹åˆ†å¸ƒ
- **balanced_distribution.json**: è®°å½•å¹³è¡¡åçš„åˆ†å¸ƒå’Œé‡‡æ ·ä¿¡æ¯
- **sampling_config.json**: è®°å½•é‡‡æ ·é…ç½®å‚æ•°
- **dataset_statistics.json**: è®°å½•æ•´ä½“ç»Ÿè®¡æ‘˜è¦

### ğŸš€ åç»­å»ºè®®

1. **å®éªŒéªŒè¯**ï¼š
   - åœ¨å¹³è¡¡æ•°æ®é›†ä¸Šé‡æ–°è¿è¡Œç°æœ‰å®éªŒ
   - æ¯”è¾ƒåŸå§‹vså¹³è¡¡æ•°æ®é›†çš„æ€§èƒ½å·®å¼‚
   - åˆ†æå¹³è¡¡ç­–ç•¥å¯¹ä¸åŒæ¨¡å‹çš„å½±å“

2. **è¿›ä¸€æ­¥ä¼˜åŒ–**ï¼š
   - å¯ä»¥å°è¯•ä¸åŒçš„æ¯ç±»æ ·æœ¬æ•°é‡é™åˆ¶ï¼ˆå¦‚64ã€256ï¼‰
   - è€ƒè™‘ç±»åˆ«æƒé‡å¹³è¡¡ç­–ç•¥
   - æ¢ç´¢æ•°æ®å¢å¼ºåœ¨ä½æ ·æœ¬ç±»åˆ«ä¸Šçš„åº”ç”¨

3. **æ‰©å±•åº”ç”¨**ï¼š
   - å°†å¹³è¡¡ç­–ç•¥åº”ç”¨åˆ°å…¶ä»–æ•°æ®é›†
   - é›†æˆåˆ°è‡ªåŠ¨åŒ–å®éªŒæµç¨‹
   - å¼€å‘å¯è§†åŒ–å·¥å…·ç›‘æ§å¹³è¡¡æ•ˆæœ

### ğŸ“ æŠ€æœ¯è§„æ ¼

- **æ¯ä¸ªç±»åˆ«æ ·æœ¬é™åˆ¶**: 128ä¸ª
- **éšæœºç§å­**: 42ï¼ˆç¡®ä¿å¯é‡ç°æ€§ï¼‰
- **è¾“å‡ºæ ¼å¼**: ä¸åŸå§‹æ•°æ®é›†ç›¸åŒçš„ç›®å½•ç»“æ„
- **å…¼å®¹æ€§**: å®Œå…¨å…¼å®¹ç°æœ‰CrossDomainDataManagerCore API
- **å…ƒæ•°æ®å®Œæ•´æ€§**: è®°å½•æ‰€æœ‰é‡‡æ ·è¿‡ç¨‹å’Œç»Ÿè®¡ä¿¡æ¯

---

**æ€»ç»“**: Cross-Domainæ•°æ®é›†é‡æ–°åˆ’åˆ†å·²æˆåŠŸå®Œæˆï¼Œæ‰€æœ‰12ä¸ªæ•°æ®é›†éƒ½å·²å¹³è¡¡å¤„ç†ï¼Œç”Ÿæˆäº†ä¸ç°æœ‰ç³»ç»Ÿå®Œå…¨å…¼å®¹çš„å¹³è¡¡æ•°æ®é›†ï¼Œä¸ºåç»­çš„è·¨åŸŸå­¦ä¹ å®éªŒæä¾›äº†æ›´å…¬å¹³å’Œå¯æ§çš„æ•°æ®ç¯å¢ƒã€‚